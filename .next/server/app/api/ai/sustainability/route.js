"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/ai/sustainability/route";
exports.ids = ["app/api/ai/sustainability/route"];
exports.modules = {

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "fs":
/*!*********************!*\
  !*** external "fs" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("fs");

/***/ }),

/***/ "http":
/*!***********************!*\
  !*** external "http" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("http");

/***/ }),

/***/ "https":
/*!************************!*\
  !*** external "https" ***!
  \************************/
/***/ ((module) => {

module.exports = require("https");

/***/ }),

/***/ "node:fs":
/*!**************************!*\
  !*** external "node:fs" ***!
  \**************************/
/***/ ((module) => {

module.exports = require("node:fs");

/***/ }),

/***/ "node:stream":
/*!******************************!*\
  !*** external "node:stream" ***!
  \******************************/
/***/ ((module) => {

module.exports = require("node:stream");

/***/ }),

/***/ "node:stream/web":
/*!**********************************!*\
  !*** external "node:stream/web" ***!
  \**********************************/
/***/ ((module) => {

module.exports = require("node:stream/web");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("path");

/***/ }),

/***/ "punycode":
/*!***************************!*\
  !*** external "punycode" ***!
  \***************************/
/***/ ((module) => {

module.exports = require("punycode");

/***/ }),

/***/ "stream":
/*!*************************!*\
  !*** external "stream" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("stream");

/***/ }),

/***/ "url":
/*!**********************!*\
  !*** external "url" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("url");

/***/ }),

/***/ "util":
/*!***********************!*\
  !*** external "util" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("util");

/***/ }),

/***/ "worker_threads":
/*!*********************************!*\
  !*** external "worker_threads" ***!
  \*********************************/
/***/ ((module) => {

module.exports = require("worker_threads");

/***/ }),

/***/ "zlib":
/*!***********************!*\
  !*** external "zlib" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("zlib");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fai%2Fsustainability%2Froute&page=%2Fapi%2Fai%2Fsustainability%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fai%2Fsustainability%2Froute.ts&appDir=C%3A%5CUsers%5Ctahay%5COneDrive%5CDesktop%5Cchallenge%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5Ctahay%5COneDrive%5CDesktop%5Cchallenge&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!***********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fai%2Fsustainability%2Froute&page=%2Fapi%2Fai%2Fsustainability%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fai%2Fsustainability%2Froute.ts&appDir=C%3A%5CUsers%5Ctahay%5COneDrive%5CDesktop%5Cchallenge%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5Ctahay%5COneDrive%5CDesktop%5Cchallenge&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \***********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var C_Users_tahay_OneDrive_Desktop_challenge_app_api_ai_sustainability_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/ai/sustainability/route.ts */ \"(rsc)/./app/api/ai/sustainability/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/ai/sustainability/route\",\n        pathname: \"/api/ai/sustainability\",\n        filename: \"route\",\n        bundlePath: \"app/api/ai/sustainability/route\"\n    },\n    resolvedPagePath: \"C:\\\\Users\\\\tahay\\\\OneDrive\\\\Desktop\\\\challenge\\\\app\\\\api\\\\ai\\\\sustainability\\\\route.ts\",\n    nextConfigOutput,\n    userland: C_Users_tahay_OneDrive_Desktop_challenge_app_api_ai_sustainability_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/ai/sustainability/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZhaSUyRnN1c3RhaW5hYmlsaXR5JTJGcm91dGUmcGFnZT0lMkZhcGklMkZhaSUyRnN1c3RhaW5hYmlsaXR5JTJGcm91dGUmYXBwUGF0aHM9JnBhZ2VQYXRoPXByaXZhdGUtbmV4dC1hcHAtZGlyJTJGYXBpJTJGYWklMkZzdXN0YWluYWJpbGl0eSUyRnJvdXRlLnRzJmFwcERpcj1DJTNBJTVDVXNlcnMlNUN0YWhheSU1Q09uZURyaXZlJTVDRGVza3RvcCU1Q2NoYWxsZW5nZSU1Q2FwcCZwYWdlRXh0ZW5zaW9ucz10c3gmcGFnZUV4dGVuc2lvbnM9dHMmcGFnZUV4dGVuc2lvbnM9anN4JnBhZ2VFeHRlbnNpb25zPWpzJnJvb3REaXI9QyUzQSU1Q1VzZXJzJTVDdGFoYXklNUNPbmVEcml2ZSU1Q0Rlc2t0b3AlNUNjaGFsbGVuZ2UmaXNEZXY9dHJ1ZSZ0c2NvbmZpZ1BhdGg9dHNjb25maWcuanNvbiZiYXNlUGF0aD0mYXNzZXRQcmVmaXg9Jm5leHRDb25maWdPdXRwdXQ9JnByZWZlcnJlZFJlZ2lvbj0mbWlkZGxld2FyZUNvbmZpZz1lMzAlM0QhIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7OztBQUFzRztBQUN2QztBQUNjO0FBQ3NDO0FBQ25IO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixnSEFBbUI7QUFDM0M7QUFDQSxjQUFjLHlFQUFTO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxZQUFZO0FBQ1osQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBLFFBQVEsaUVBQWlFO0FBQ3pFO0FBQ0E7QUFDQSxXQUFXLDRFQUFXO0FBQ3RCO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDdUg7O0FBRXZIIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcmlobGEvPzg4YmUiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQXBwUm91dGVSb3V0ZU1vZHVsZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1tb2R1bGVzL2FwcC1yb3V0ZS9tb2R1bGUuY29tcGlsZWRcIjtcbmltcG9ydCB7IFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1raW5kXCI7XG5pbXBvcnQgeyBwYXRjaEZldGNoIGFzIF9wYXRjaEZldGNoIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvbGliL3BhdGNoLWZldGNoXCI7XG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiQzpcXFxcVXNlcnNcXFxcdGFoYXlcXFxcT25lRHJpdmVcXFxcRGVza3RvcFxcXFxjaGFsbGVuZ2VcXFxcYXBwXFxcXGFwaVxcXFxhaVxcXFxzdXN0YWluYWJpbGl0eVxcXFxyb3V0ZS50c1wiO1xuLy8gV2UgaW5qZWN0IHRoZSBuZXh0Q29uZmlnT3V0cHV0IGhlcmUgc28gdGhhdCB3ZSBjYW4gdXNlIHRoZW0gaW4gdGhlIHJvdXRlXG4vLyBtb2R1bGUuXG5jb25zdCBuZXh0Q29uZmlnT3V0cHV0ID0gXCJcIlxuY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgQXBwUm91dGVSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuQVBQX1JPVVRFLFxuICAgICAgICBwYWdlOiBcIi9hcGkvYWkvc3VzdGFpbmFiaWxpdHkvcm91dGVcIixcbiAgICAgICAgcGF0aG5hbWU6IFwiL2FwaS9haS9zdXN0YWluYWJpbGl0eVwiLFxuICAgICAgICBmaWxlbmFtZTogXCJyb3V0ZVwiLFxuICAgICAgICBidW5kbGVQYXRoOiBcImFwcC9hcGkvYWkvc3VzdGFpbmFiaWxpdHkvcm91dGVcIlxuICAgIH0sXG4gICAgcmVzb2x2ZWRQYWdlUGF0aDogXCJDOlxcXFxVc2Vyc1xcXFx0YWhheVxcXFxPbmVEcml2ZVxcXFxEZXNrdG9wXFxcXGNoYWxsZW5nZVxcXFxhcHBcXFxcYXBpXFxcXGFpXFxcXHN1c3RhaW5hYmlsaXR5XFxcXHJvdXRlLnRzXCIsXG4gICAgbmV4dENvbmZpZ091dHB1dCxcbiAgICB1c2VybGFuZFxufSk7XG4vLyBQdWxsIG91dCB0aGUgZXhwb3J0cyB0aGF0IHdlIG5lZWQgdG8gZXhwb3NlIGZyb20gdGhlIG1vZHVsZS4gVGhpcyBzaG91bGRcbi8vIGJlIGVsaW1pbmF0ZWQgd2hlbiB3ZSd2ZSBtb3ZlZCB0aGUgb3RoZXIgcm91dGVzIHRvIHRoZSBuZXcgZm9ybWF0LiBUaGVzZVxuLy8gYXJlIHVzZWQgdG8gaG9vayBpbnRvIHRoZSByb3V0ZS5cbmNvbnN0IHsgcmVxdWVzdEFzeW5jU3RvcmFnZSwgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MgfSA9IHJvdXRlTW9kdWxlO1xuY29uc3Qgb3JpZ2luYWxQYXRobmFtZSA9IFwiL2FwaS9haS9zdXN0YWluYWJpbGl0eS9yb3V0ZVwiO1xuZnVuY3Rpb24gcGF0Y2hGZXRjaCgpIHtcbiAgICByZXR1cm4gX3BhdGNoRmV0Y2goe1xuICAgICAgICBzZXJ2ZXJIb29rcyxcbiAgICAgICAgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZVxuICAgIH0pO1xufVxuZXhwb3J0IHsgcm91dGVNb2R1bGUsIHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzLCBvcmlnaW5hbFBhdGhuYW1lLCBwYXRjaEZldGNoLCAgfTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YXBwLXJvdXRlLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fai%2Fsustainability%2Froute&page=%2Fapi%2Fai%2Fsustainability%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fai%2Fsustainability%2Froute.ts&appDir=C%3A%5CUsers%5Ctahay%5COneDrive%5CDesktop%5Cchallenge%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5Ctahay%5COneDrive%5CDesktop%5Cchallenge&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/api/ai/sustainability/route.ts":
/*!********************************************!*\
  !*** ./app/api/ai/sustainability/route.ts ***!
  \********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var _lib_openrouter__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/openrouter */ \"(rsc)/./lib/openrouter.ts\");\n\n\nasync function POST(req) {\n    console.log(\"\\uD83C\\uDF0D Sustainability API: Received request\");\n    try {\n        const body = await req.json();\n        console.log(\"\\uD83C\\uDF0D Request body:\", body);\n        // Validate input\n        if (!body.name || !body.country || !body.month) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Missing required fields: name, country, and month are required\"\n            }, {\n                status: 400\n            });\n        }\n        // Validate month\n        const validMonths = [\n            \"Jan\",\n            \"Feb\",\n            \"Mar\",\n            \"Apr\",\n            \"May\",\n            \"Jun\",\n            \"Jul\",\n            \"Aug\",\n            \"Sep\",\n            \"Oct\",\n            \"Nov\",\n            \"Dec\"\n        ];\n        if (!validMonths.includes(body.month)) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Invalid month. Must be three-letter abbreviation (e.g., Jan, Feb)\"\n            }, {\n                status: 400\n            });\n        }\n        // Check API key\n        if (!process.env.OPENROUTER_API_KEY) {\n            console.error(\"\\uD83C\\uDF0D OPENROUTER_API_KEY is not set\");\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"OpenRouter API key not configured\"\n            }, {\n                status: 500\n            });\n        }\n        // Call OpenRouter\n        console.log(\"\\uD83C\\uDF0D Calling getSustainabilityInsights...\");\n        const result = await (0,_lib_openrouter__WEBPACK_IMPORTED_MODULE_1__.getSustainabilityInsights)({\n            name: body.name,\n            country: body.country,\n            month: body.month,\n            visitor_count: body.visitor_count\n        });\n        console.log(\"\\uD83C\\uDF0D Sustainability insights generated successfully\");\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json(result);\n    } catch (error) {\n        console.error(\"\\uD83C\\uDF0D Sustainability API Error:\", {\n            name: error.name,\n            message: error.message,\n            status: error.status,\n            stack: error.stack\n        });\n        // Check for specific OpenRouter errors\n        if (error.status === 404) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"The selected AI model is not available. Please try again later.\"\n            }, {\n                status: 503\n            });\n        }\n        if (error.status === 429) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Rate limit exceeded. Please try again in a moment.\"\n            }, {\n                status: 429\n            });\n        }\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: \"Failed to generate sustainability insights\",\n            details:  true ? error.message : 0\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9hcHAvYXBpL2FpL3N1c3RhaW5hYmlsaXR5L3JvdXRlLnRzIiwibWFwcGluZ3MiOiI7Ozs7OztBQUF3RDtBQUNLO0FBRXRELGVBQWVFLEtBQUtDLEdBQWdCO0lBQ3pDQyxRQUFRQyxHQUFHLENBQUM7SUFFWixJQUFJO1FBQ0YsTUFBTUMsT0FBTyxNQUFNSCxJQUFJSSxJQUFJO1FBQzNCSCxRQUFRQyxHQUFHLENBQUMsOEJBQW9CQztRQUVoQyxpQkFBaUI7UUFDakIsSUFBSSxDQUFDQSxLQUFLRSxJQUFJLElBQUksQ0FBQ0YsS0FBS0csT0FBTyxJQUFJLENBQUNILEtBQUtJLEtBQUssRUFBRTtZQUM5QyxPQUFPVixxREFBWUEsQ0FBQ08sSUFBSSxDQUN0QjtnQkFBRUksT0FBTztZQUFpRSxHQUMxRTtnQkFBRUMsUUFBUTtZQUFJO1FBRWxCO1FBRUEsaUJBQWlCO1FBQ2pCLE1BQU1DLGNBQWM7WUFBQztZQUFPO1lBQU87WUFBTztZQUFPO1lBQU87WUFBTztZQUFPO1lBQU87WUFBTztZQUFPO1lBQU87U0FBTTtRQUN4RyxJQUFJLENBQUNBLFlBQVlDLFFBQVEsQ0FBQ1IsS0FBS0ksS0FBSyxHQUFHO1lBQ3JDLE9BQU9WLHFEQUFZQSxDQUFDTyxJQUFJLENBQ3RCO2dCQUFFSSxPQUFPO1lBQW9FLEdBQzdFO2dCQUFFQyxRQUFRO1lBQUk7UUFFbEI7UUFFQSxnQkFBZ0I7UUFDaEIsSUFBSSxDQUFDRyxRQUFRQyxHQUFHLENBQUNDLGtCQUFrQixFQUFFO1lBQ25DYixRQUFRTyxLQUFLLENBQUM7WUFDZCxPQUFPWCxxREFBWUEsQ0FBQ08sSUFBSSxDQUN0QjtnQkFBRUksT0FBTztZQUFvQyxHQUM3QztnQkFBRUMsUUFBUTtZQUFJO1FBRWxCO1FBRUEsa0JBQWtCO1FBQ2xCUixRQUFRQyxHQUFHLENBQUM7UUFDWixNQUFNYSxTQUFTLE1BQU1qQiwwRUFBeUJBLENBQUM7WUFDN0NPLE1BQU1GLEtBQUtFLElBQUk7WUFDZkMsU0FBU0gsS0FBS0csT0FBTztZQUNyQkMsT0FBT0osS0FBS0ksS0FBSztZQUNqQlMsZUFBZWIsS0FBS2EsYUFBYTtRQUNuQztRQUVBZixRQUFRQyxHQUFHLENBQUM7UUFDWixPQUFPTCxxREFBWUEsQ0FBQ08sSUFBSSxDQUFDVztJQUUzQixFQUFFLE9BQU9QLE9BQVk7UUFDbkJQLFFBQVFPLEtBQUssQ0FBQywwQ0FBZ0M7WUFDNUNILE1BQU1HLE1BQU1ILElBQUk7WUFDaEJZLFNBQVNULE1BQU1TLE9BQU87WUFDdEJSLFFBQVFELE1BQU1DLE1BQU07WUFDcEJTLE9BQU9WLE1BQU1VLEtBQUs7UUFDcEI7UUFFQSx1Q0FBdUM7UUFDdkMsSUFBSVYsTUFBTUMsTUFBTSxLQUFLLEtBQUs7WUFDeEIsT0FBT1oscURBQVlBLENBQUNPLElBQUksQ0FDdEI7Z0JBQUVJLE9BQU87WUFBa0UsR0FDM0U7Z0JBQUVDLFFBQVE7WUFBSTtRQUVsQjtRQUVBLElBQUlELE1BQU1DLE1BQU0sS0FBSyxLQUFLO1lBQ3hCLE9BQU9aLHFEQUFZQSxDQUFDTyxJQUFJLENBQ3RCO2dCQUFFSSxPQUFPO1lBQXFELEdBQzlEO2dCQUFFQyxRQUFRO1lBQUk7UUFFbEI7UUFFQSxPQUFPWixxREFBWUEsQ0FBQ08sSUFBSSxDQUN0QjtZQUNFSSxPQUFPO1lBQ1BXLFNBQVNQLEtBQXNDLEdBQUdKLE1BQU1TLE9BQU8sR0FBR0csQ0FBU0E7UUFDN0UsR0FDQTtZQUFFWCxRQUFRO1FBQUk7SUFFbEI7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL3JpaGxhLy4vYXBwL2FwaS9haS9zdXN0YWluYWJpbGl0eS9yb3V0ZS50cz8yODdkIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE5leHRSZXF1ZXN0LCBOZXh0UmVzcG9uc2UgfSBmcm9tIFwibmV4dC9zZXJ2ZXJcIjtcbmltcG9ydCB7IGdldFN1c3RhaW5hYmlsaXR5SW5zaWdodHMgfSBmcm9tIFwiQC9saWIvb3BlbnJvdXRlclwiO1xuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gUE9TVChyZXE6IE5leHRSZXF1ZXN0KSB7XG4gIGNvbnNvbGUubG9nKFwi8J+MjSBTdXN0YWluYWJpbGl0eSBBUEk6IFJlY2VpdmVkIHJlcXVlc3RcIik7XG4gIFxuICB0cnkge1xuICAgIGNvbnN0IGJvZHkgPSBhd2FpdCByZXEuanNvbigpO1xuICAgIGNvbnNvbGUubG9nKFwi8J+MjSBSZXF1ZXN0IGJvZHk6XCIsIGJvZHkpO1xuXG4gICAgLy8gVmFsaWRhdGUgaW5wdXRcbiAgICBpZiAoIWJvZHkubmFtZSB8fCAhYm9keS5jb3VudHJ5IHx8ICFib2R5Lm1vbnRoKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgIHsgZXJyb3I6IFwiTWlzc2luZyByZXF1aXJlZCBmaWVsZHM6IG5hbWUsIGNvdW50cnksIGFuZCBtb250aCBhcmUgcmVxdWlyZWRcIiB9LFxuICAgICAgICB7IHN0YXR1czogNDAwIH1cbiAgICAgICk7XG4gICAgfVxuXG4gICAgLy8gVmFsaWRhdGUgbW9udGhcbiAgICBjb25zdCB2YWxpZE1vbnRocyA9IFtcIkphblwiLCBcIkZlYlwiLCBcIk1hclwiLCBcIkFwclwiLCBcIk1heVwiLCBcIkp1blwiLCBcIkp1bFwiLCBcIkF1Z1wiLCBcIlNlcFwiLCBcIk9jdFwiLCBcIk5vdlwiLCBcIkRlY1wiXTtcbiAgICBpZiAoIXZhbGlkTW9udGhzLmluY2x1ZGVzKGJvZHkubW9udGgpKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgIHsgZXJyb3I6IFwiSW52YWxpZCBtb250aC4gTXVzdCBiZSB0aHJlZS1sZXR0ZXIgYWJicmV2aWF0aW9uIChlLmcuLCBKYW4sIEZlYilcIiB9LFxuICAgICAgICB7IHN0YXR1czogNDAwIH1cbiAgICAgICk7XG4gICAgfVxuXG4gICAgLy8gQ2hlY2sgQVBJIGtleVxuICAgIGlmICghcHJvY2Vzcy5lbnYuT1BFTlJPVVRFUl9BUElfS0VZKSB7XG4gICAgICBjb25zb2xlLmVycm9yKFwi8J+MjSBPUEVOUk9VVEVSX0FQSV9LRVkgaXMgbm90IHNldFwiKTtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgICAgeyBlcnJvcjogXCJPcGVuUm91dGVyIEFQSSBrZXkgbm90IGNvbmZpZ3VyZWRcIiB9LFxuICAgICAgICB7IHN0YXR1czogNTAwIH1cbiAgICAgICk7XG4gICAgfVxuXG4gICAgLy8gQ2FsbCBPcGVuUm91dGVyXG4gICAgY29uc29sZS5sb2coXCLwn4yNIENhbGxpbmcgZ2V0U3VzdGFpbmFiaWxpdHlJbnNpZ2h0cy4uLlwiKTtcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBnZXRTdXN0YWluYWJpbGl0eUluc2lnaHRzKHtcbiAgICAgIG5hbWU6IGJvZHkubmFtZSxcbiAgICAgIGNvdW50cnk6IGJvZHkuY291bnRyeSxcbiAgICAgIG1vbnRoOiBib2R5Lm1vbnRoLFxuICAgICAgdmlzaXRvcl9jb3VudDogYm9keS52aXNpdG9yX2NvdW50XG4gICAgfSk7XG5cbiAgICBjb25zb2xlLmxvZyhcIvCfjI0gU3VzdGFpbmFiaWxpdHkgaW5zaWdodHMgZ2VuZXJhdGVkIHN1Y2Nlc3NmdWxseVwiKTtcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24ocmVzdWx0KTtcblxuICB9IGNhdGNoIChlcnJvcjogYW55KSB7XG4gICAgY29uc29sZS5lcnJvcihcIvCfjI0gU3VzdGFpbmFiaWxpdHkgQVBJIEVycm9yOlwiLCB7XG4gICAgICBuYW1lOiBlcnJvci5uYW1lLFxuICAgICAgbWVzc2FnZTogZXJyb3IubWVzc2FnZSxcbiAgICAgIHN0YXR1czogZXJyb3Iuc3RhdHVzLFxuICAgICAgc3RhY2s6IGVycm9yLnN0YWNrXG4gICAgfSk7XG5cbiAgICAvLyBDaGVjayBmb3Igc3BlY2lmaWMgT3BlblJvdXRlciBlcnJvcnNcbiAgICBpZiAoZXJyb3Iuc3RhdHVzID09PSA0MDQpIHtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgICAgeyBlcnJvcjogXCJUaGUgc2VsZWN0ZWQgQUkgbW9kZWwgaXMgbm90IGF2YWlsYWJsZS4gUGxlYXNlIHRyeSBhZ2FpbiBsYXRlci5cIiB9LFxuICAgICAgICB7IHN0YXR1czogNTAzIH1cbiAgICAgICk7XG4gICAgfVxuXG4gICAgaWYgKGVycm9yLnN0YXR1cyA9PT0gNDI5KSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgIHsgZXJyb3I6IFwiUmF0ZSBsaW1pdCBleGNlZWRlZC4gUGxlYXNlIHRyeSBhZ2FpbiBpbiBhIG1vbWVudC5cIiB9LFxuICAgICAgICB7IHN0YXR1czogNDI5IH1cbiAgICAgICk7XG4gICAgfVxuXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgeyBcbiAgICAgICAgZXJyb3I6IFwiRmFpbGVkIHRvIGdlbmVyYXRlIHN1c3RhaW5hYmlsaXR5IGluc2lnaHRzXCIsXG4gICAgICAgIGRldGFpbHM6IHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSBcImRldmVsb3BtZW50XCIgPyBlcnJvci5tZXNzYWdlIDogdW5kZWZpbmVkXG4gICAgICB9LFxuICAgICAgeyBzdGF0dXM6IDUwMCB9XG4gICAgKTtcbiAgfVxufSJdLCJuYW1lcyI6WyJOZXh0UmVzcG9uc2UiLCJnZXRTdXN0YWluYWJpbGl0eUluc2lnaHRzIiwiUE9TVCIsInJlcSIsImNvbnNvbGUiLCJsb2ciLCJib2R5IiwianNvbiIsIm5hbWUiLCJjb3VudHJ5IiwibW9udGgiLCJlcnJvciIsInN0YXR1cyIsInZhbGlkTW9udGhzIiwiaW5jbHVkZXMiLCJwcm9jZXNzIiwiZW52IiwiT1BFTlJPVVRFUl9BUElfS0VZIiwicmVzdWx0IiwidmlzaXRvcl9jb3VudCIsIm1lc3NhZ2UiLCJzdGFjayIsImRldGFpbHMiLCJ1bmRlZmluZWQiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./app/api/ai/sustainability/route.ts\n");

/***/ }),

/***/ "(rsc)/./lib/openrouter.ts":
/*!***************************!*\
  !*** ./lib/openrouter.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   MODEL: () => (/* binding */ MODEL),\n/* harmony export */   MODEL_FAST: () => (/* binding */ MODEL_FAST),\n/* harmony export */   MODEL_FREE: () => (/* binding */ MODEL_FREE),\n/* harmony export */   MODEL_VISION: () => (/* binding */ MODEL_VISION),\n/* harmony export */   generateItinerary: () => (/* binding */ generateItinerary),\n/* harmony export */   getSustainabilityInsights: () => (/* binding */ getSustainabilityInsights),\n/* harmony export */   recognizeHeritage: () => (/* binding */ recognizeHeritage),\n/* harmony export */   travelChat: () => (/* binding */ travelChat)\n/* harmony export */ });\n/* harmony import */ var openai__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! openai */ \"(rsc)/./node_modules/openai/index.mjs\");\n\n// Initialize OpenAI client with error handling\nlet openrouter;\ntry {\n    if (!process.env.OPENROUTER_API_KEY) {\n        throw new Error(\"OPENROUTER_API_KEY is not defined in environment variables\");\n    }\n    openrouter = new openai__WEBPACK_IMPORTED_MODULE_0__[\"default\"]({\n        baseURL: \"https://openrouter.ai/api/v1\",\n        apiKey: process.env.OPENROUTER_API_KEY,\n        defaultHeaders: {\n            \"HTTP-Referer\": \"http://localhost:3000\" || 0,\n            \"X-Title\": \"Rihla - AI Tourism Ecosystem\"\n        },\n        timeout: 30000,\n        maxRetries: 2\n    });\n    console.log(\"‚úÖ OpenRouter client initialized successfully\");\n} catch (error) {\n    console.error(\"‚ùå Failed to initialize OpenRouter client:\", error);\n    throw error;\n}\n// FIXED MODELS - Using only models that definitely work\nconst MODEL = \"meta-llama/llama-3.3-70b-instruct\"; // Paid model (works)\nconst MODEL_FAST = \"meta-llama/llama-3.2-3b-instruct\"; // Paid model (cheap)\nconst MODEL_FREE = \"gryphe/mythomax-l2-13b:free\"; // Free model that works\n// For vision tasks (image recognition)\nconst MODEL_VISION = \"anthropic/claude-3-haiku\"; // Paid but reliable for images\n// ‚îÄ‚îÄ‚îÄ 1. Travel Planning Chat ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\nasync function travelChat(messages, context) {\n    try {\n        console.log(\"\\uD83E\\uDD16 travelChat called with\", {\n            messagesCount: messages.length,\n            context\n        });\n        const system = `You are Rihla AI ‚Äî an expert travel concierge specialising in Tunisia, North Africa and the Maghreb region.\nYou have deep knowledge of: Tunisian culture, history, cuisine, geography, hidden gems, Sahara Desert, Medinas, Carthage, Djerba, Sidi Bou Said, Kairouan, Douz, Tataouine, Tozeur, Cap Bon, and beyond.\nYou also know Morocco, Algeria, Libya, Egypt and the broader MENA region.\n${context?.country ? `Current focus: ${context.country}` : \"\"}\n${context?.interests?.length ? `Traveller interests: ${context.interests.join(\", \")}` : \"\"}\n\nBe warm, knowledgeable, and inspiring. Give specific, actionable advice. Mention exact places, local dishes, cultural customs.\nRespond in 2-4 paragraphs. Use markdown formatting where helpful. Never be generic.`;\n        const res = await openrouter.chat.completions.create({\n            model: MODEL,\n            messages: [\n                {\n                    role: \"system\",\n                    content: system\n                },\n                ...messages\n            ],\n            max_tokens: 900,\n            temperature: 0.7\n        });\n        const content = res.choices[0]?.message?.content;\n        if (!content) throw new Error(\"No content in response\");\n        return content;\n    } catch (error) {\n        console.error(\"‚ùå travelChat error:\", error);\n        throw error;\n    }\n}\n// ‚îÄ‚îÄ‚îÄ 2. Personalised Itinerary Generator ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\nasync function generateItinerary(params) {\n    console.log(\"\\uD83D\\uDDFAÔ∏è generateItinerary called with:\", params);\n    try {\n        if (!params.country) throw new Error(\"Country is required\");\n        if (params.days < 1 || params.days > 30) throw new Error(\"Days must be between 1 and 30\");\n        const prompt = `Create a detailed ${params.days}-day travel itinerary for ${params.country}.\n\nTraveller profile:\n- Style: ${params.travel_style}\n- Budget: ${params.budget}\n- Interests: ${params.interests.join(\", \")}\n${params.special_requests ? `- Special requests: ${params.special_requests}` : \"\"}\n\nIMPORTANT: You must respond with ONLY valid JSON. Do not include any other text, markdown, or explanations.\n\nThe JSON must follow this exact structure:\n{\n  \"title\": \"A descriptive title for this itinerary\",\n  \"ai_highlights\": [\"Highlight 1\", \"Highlight 2\", \"Highlight 3\"],\n  \"estimated_cost\": \"Budget estimate in local currency or USD\",\n  \"sustainability_tips\": [\"Tip 1\", \"Tip 2\", \"Tip 3\"],\n  \"days\": [\n    {\n      \"day\": 1,\n      \"title\": \"Day title\",\n      \"theme\": \"Theme of the day\",\n      \"tips\": \"Practical tips for the day\",\n      \"accommodation\": \"Recommended accommodation\",\n      \"destinations\": [\n        {\n          \"name\": \"Place name\",\n          \"duration_hours\": 2,\n          \"activity\": \"Activity description\",\n          \"notes\": \"Additional notes\",\n          \"order\": 1\n        }\n      ]\n    }\n  ]\n}\n\nMake it deeply specific to ${params.country}. Include local cuisine recommendations, cultural etiquette, hidden gems.\nFor Tunisia: include medinas, archaeological sites, desert experiences, coastal towns as appropriate.`;\n        console.log(\"\\uD83D\\uDDFAÔ∏è Sending request to OpenRouter...\");\n        const res = await openrouter.chat.completions.create({\n            model: MODEL,\n            messages: [\n                {\n                    role: \"user\",\n                    content: prompt\n                }\n            ],\n            max_tokens: 3000,\n            temperature: 0.7\n        });\n        console.log(\"\\uD83D\\uDDFAÔ∏è Received response from OpenRouter\");\n        const content = res.choices[0]?.message?.content;\n        if (!content) {\n            throw new Error(\"Empty response from OpenRouter\");\n        }\n        console.log(\"\\uD83D\\uDDFAÔ∏è Raw response preview:\", content.substring(0, 200) + \"...\");\n        let jsonContent = content;\n        jsonContent = jsonContent.replace(/```json\\n?/g, \"\").replace(/```\\n?/g, \"\");\n        const jsonMatch = jsonContent.match(/\\{[\\s\\S]*\\}/);\n        if (jsonMatch) {\n            jsonContent = jsonMatch[0];\n        }\n        try {\n            const parsed = JSON.parse(jsonContent);\n            console.log(\"\\uD83D\\uDDFAÔ∏è Successfully parsed JSON response\");\n            return parsed;\n        } catch (parseError) {\n            console.error(\"‚ùå Failed to parse JSON. Raw content:\", content);\n            throw new Error(`AI response was not valid JSON: ${parseError.message}`);\n        }\n    } catch (error) {\n        console.error(\"‚ùå generateItinerary error:\", {\n            message: error.message,\n            status: error.status,\n            response: error.response?.data\n        });\n        throw error;\n    }\n}\n// ‚îÄ‚îÄ‚îÄ 3. Cultural Heritage Recognition ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\nasync function recognizeHeritage(input) {\n    try {\n        console.log(\"\\uD83C\\uDFDBÔ∏è recognizeHeritage called with:\", {\n            type: input.type,\n            country_hint: input.country_hint\n        });\n        const prompt = input.type === \"description\" ? `A traveller describes this heritage site or landmark: \"${input.value}\"\n${input.country_hint ? `It may be in: ${input.country_hint}` : \"\"}\n\nIdentify the site and provide rich cultural context.` : `Analyze this heritage site image from ${input.country_hint || \"North Africa / Mediterranean\"}.\nImage URL: ${input.value}\nIdentify and describe the cultural heritage site shown.`;\n        const fullPrompt = `${prompt}\n\nReturn ONLY valid JSON. Do not include any other text, markdown, or explanations.\n\nThe JSON must follow this exact structure:\n{\n  \"site_name\": \"Name of the site\",\n  \"confidence\": 85,\n  \"country\": \"Country name\",\n  \"city\": \"City name\",\n  \"period\": \"Historical period\",\n  \"civilization\": \"Civilization name\",\n  \"description\": \"Detailed description\",\n  \"historical_context\": \"Historical context information\",\n  \"fun_facts\": [\"Fun fact 1\", \"Fun fact 2\", \"Fun fact 3\"],\n  \"visitor_tips\": \"Tips for visitors\",\n  \"nearby_sites\": [\"Nearby site 1\", \"Nearby site 2\", \"Nearby site 3\"],\n  \"best_time_to_visit\": \"Best time information\",\n  \"unesco\": true,\n  \"significance\": \"Cultural significance\"\n}`;\n        // FIXED: Use the appropriate model based on input type\n        const modelToUse = input.type === \"image_url\" ? \"anthropic/claude-3-haiku\" // For images\n         : MODEL_FAST; // For text descriptions - using the working fast model\n        console.log(`üèõÔ∏è Using model: ${modelToUse}`);\n        const messages = input.type === \"image_url\" ? [\n            {\n                role: \"user\",\n                content: [\n                    {\n                        type: \"image_url\",\n                        image_url: {\n                            url: input.value\n                        }\n                    },\n                    {\n                        type: \"text\",\n                        text: fullPrompt\n                    }\n                ]\n            }\n        ] : [\n            {\n                role: \"user\",\n                content: fullPrompt\n            }\n        ];\n        const res = await openrouter.chat.completions.create({\n            model: modelToUse,\n            messages,\n            max_tokens: 1500,\n            temperature: 0.7\n        });\n        const content = res.choices[0]?.message?.content;\n        if (!content) throw new Error(\"No response from AI\");\n        console.log(\"\\uD83C\\uDFDBÔ∏è Raw response preview:\", content.substring(0, 200) + \"...\");\n        // Clean and parse JSON\n        let jsonContent = content.replace(/```json\\n?/g, \"\").replace(/```\\n?/g, \"\");\n        const jsonMatch = jsonContent.match(/\\{[\\s\\S]*\\}/);\n        if (jsonMatch) jsonContent = jsonMatch[0];\n        const parsed = JSON.parse(jsonContent);\n        console.log(\"\\uD83C\\uDFDBÔ∏è Successfully parsed JSON response\");\n        return parsed;\n    } catch (error) {\n        console.error(\"‚ùå recognizeHeritage error:\", error);\n        throw error;\n    }\n}\n// ‚îÄ‚îÄ‚îÄ 4. Sustainability & Crowd Insights ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\nasync function getSustainabilityInsights(destination) {\n    try {\n        console.log(\"\\uD83C\\uDF31 getSustainabilityInsights called with:\", destination);\n        const prompt = `Provide sustainability and crowd management insights for \"${destination.name}\", ${destination.country} in ${destination.month}.\n${destination.visitor_count ? `Current monthly visitors: ${destination.visitor_count}` : \"\"}\n\nReturn ONLY valid JSON. Do not include any other text, markdown, or explanations.\n\nThe JSON must follow this exact structure:\n{\n  \"crowd_forecast\": \"low|moderate|high\",\n  \"crowd_score\": 65,\n  \"best_visit_times\": [\"Early morning (7-9am)\", \"Late afternoon (4-6pm)\"],\n  \"eco_score\": 72,\n  \"carbon_estimate_kg\": 12.5,\n  \"water_stress\": \"low|moderate|high\",\n  \"sustainability_rating\": \"A|B|C|D\",\n  \"green_practices\": [\"Use public transport\", \"Support local businesses\"],\n  \"responsible_tips\": [\"Bring reusable water bottle\", \"Respect local customs\"],\n  \"avoid_periods\": [\"Peak tourist season (Jul-Aug)\", \"Weekend afternoons\"],\n  \"local_initiatives\": [\"Beach cleanup program\", \"Local conservation project\"],\n  \"alternative_destinations\": [\"Nearby less-visited site 1\", \"Nearby less-visited site 2\"],\n  \"carrying_capacity_alert\": false,\n  \"monthly_trend\": [\n    {\"month\": \"Jan\", \"visitors\": 1200, \"eco_score\": 85},\n    {\"month\": \"Feb\", \"visitors\": 1100, \"eco_score\": 87},\n    {\"month\": \"Mar\", \"visitors\": 1500, \"eco_score\": 80},\n    {\"month\": \"Apr\", \"visitors\": 2200, \"eco_score\": 74},\n    {\"month\": \"May\", \"visitors\": 3100, \"eco_score\": 68},\n    {\"month\": \"Jun\", \"visitors\": 4200, \"eco_score\": 58},\n    {\"month\": \"Jul\", \"visitors\": 5500, \"eco_score\": 45},\n    {\"month\": \"Aug\", \"visitors\": 6200, \"eco_score\": 40},\n    {\"month\": \"Sep\", \"visitors\": 3800, \"eco_score\": 62},\n    {\"month\": \"Oct\", \"visitors\": 2500, \"eco_score\": 72},\n    {\"month\": \"Nov\", \"visitors\": 1600, \"eco_score\": 81},\n    {\"month\": \"Dec\", \"visitors\": 1300, \"eco_score\": 84}\n  ]\n}\n\nBase your response on typical Mediterranean/North African tourism patterns.\nFor ${destination.name} in ${destination.country}, consider:\n- Peak tourist seasons (spring and autumn for cultural sites, summer for coastal)\n- Local climate and environmental pressures\n- Typical visitor patterns\n- Local sustainability initiatives`;\n        console.log(\"\\uD83C\\uDF31 Sending request to OpenRouter with model:\", MODEL_FAST);\n        const res = await openrouter.chat.completions.create({\n            model: MODEL_FAST,\n            messages: [\n                {\n                    role: \"user\",\n                    content: prompt\n                }\n            ],\n            max_tokens: 1500,\n            temperature: 0.7\n        });\n        console.log(\"\\uD83C\\uDF31 Received response from OpenRouter\");\n        const content = res.choices[0]?.message?.content;\n        if (!content) throw new Error(\"No response from AI\");\n        console.log(\"\\uD83C\\uDF31 Raw response preview:\", content.substring(0, 200) + \"...\");\n        // Clean and parse JSON\n        let jsonContent = content.replace(/```json\\n?/g, \"\").replace(/```\\n?/g, \"\");\n        const jsonMatch = jsonContent.match(/\\{[\\s\\S]*\\}/);\n        if (jsonMatch) jsonContent = jsonMatch[0];\n        const parsed = JSON.parse(jsonContent);\n        console.log(\"\\uD83C\\uDF31 Successfully parsed JSON response\");\n        return parsed;\n    } catch (error) {\n        console.error(\"‚ùå getSustainabilityInsights error:\", {\n            message: error.message,\n            status: error.status,\n            response: error.response?.data\n        });\n        throw error;\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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TUFBTTNCLFdBQVc0QixJQUFJLENBQUNDLFdBQVcsQ0FBQ0MsTUFBTSxDQUFDO1lBQ25EQyxPQUFPaEI7WUFDUEksVUFBVTtnQkFBQztvQkFBRWEsTUFBTTtvQkFBUUMsU0FBU1E7Z0JBQU87YUFBRTtZQUM3Q1AsWUFBWTtZQUNaQyxhQUFhO1FBQ2Y7UUFFQXhCLFFBQVFDLEdBQUcsQ0FBQztRQUVaLE1BQU1xQixVQUFVTixJQUFJUyxPQUFPLENBQUMsRUFBRSxFQUFFQyxTQUFTSjtRQUN6QyxJQUFJLENBQUNBLFNBQVMsTUFBTSxJQUFJN0IsTUFBTTtRQUU5Qk8sUUFBUUMsR0FBRyxDQUFDLHNDQUE0QnFCLFFBQVFZLFNBQVMsQ0FBQyxHQUFHLE9BQU87UUFFcEUsdUJBQXVCO1FBQ3ZCLElBQUlDLGNBQWNiLFFBQVFjLE9BQU8sQ0FBQyxlQUFlLElBQUlBLE9BQU8sQ0FBQyxXQUFXO1FBQ3hFLE1BQU1DLFlBQVlGLFlBQVlHLEtBQUssQ0FBQztRQUNwQyxJQUFJRCxXQUFXRixjQUFjRSxTQUFTLENBQUMsRUFBRTtRQUV6QyxNQUFNRSxTQUFTQyxLQUFLQyxLQUFLLENBQUNOO1FBQzFCbkMsUUFBUUMsR0FBRyxDQUFDO1FBQ1osT0FBT3NDO0lBRVQsRUFBRSxPQUFPckMsT0FBWTtRQUNuQkYsUUFBUUUsS0FBSyxDQUFDLHNDQUFzQztZQUNsRHdCLFNBQVN4QixNQUFNd0IsT0FBTztZQUN0QmlCLFFBQVF6QyxNQUFNeUMsTUFBTTtZQUNwQkMsVUFBVTFDLE1BQU0wQyxRQUFRLEVBQUVDO1FBQzVCO1FBQ0EsTUFBTTNDO0lBQ1I7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL3JpaGxhLy4vbGliL29wZW5yb3V0ZXIudHM/YTY4MyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgT3BlbkFJIGZyb20gXCJvcGVuYWlcIjtcblxuLy8gSW5pdGlhbGl6ZSBPcGVuQUkgY2xpZW50IHdpdGggZXJyb3IgaGFuZGxpbmdcbmxldCBvcGVucm91dGVyOiBPcGVuQUk7XG5cbnRyeSB7XG4gIGlmICghcHJvY2Vzcy5lbnYuT1BFTlJPVVRFUl9BUElfS0VZKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKFwiT1BFTlJPVVRFUl9BUElfS0VZIGlzIG5vdCBkZWZpbmVkIGluIGVudmlyb25tZW50IHZhcmlhYmxlc1wiKTtcbiAgfVxuXG4gIG9wZW5yb3V0ZXIgPSBuZXcgT3BlbkFJKHtcbiAgICBiYXNlVVJMOiBcImh0dHBzOi8vb3BlbnJvdXRlci5haS9hcGkvdjFcIixcbiAgICBhcGlLZXk6IHByb2Nlc3MuZW52Lk9QRU5ST1VURVJfQVBJX0tFWSxcbiAgICBkZWZhdWx0SGVhZGVyczoge1xuICAgICAgXCJIVFRQLVJlZmVyZXJcIjogcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfQVBQX1VSTCB8fCBcImh0dHA6Ly9sb2NhbGhvc3Q6MzAwMFwiLFxuICAgICAgXCJYLVRpdGxlXCI6IFwiUmlobGEgLSBBSSBUb3VyaXNtIEVjb3N5c3RlbVwiLFxuICAgIH0sXG4gICAgdGltZW91dDogMzAwMDAsXG4gICAgbWF4UmV0cmllczogMixcbiAgfSk7XG5cbiAgY29uc29sZS5sb2coXCLinIUgT3BlblJvdXRlciBjbGllbnQgaW5pdGlhbGl6ZWQgc3VjY2Vzc2Z1bGx5XCIpO1xufSBjYXRjaCAoZXJyb3IpIHtcbiAgY29uc29sZS5lcnJvcihcIuKdjCBGYWlsZWQgdG8gaW5pdGlhbGl6ZSBPcGVuUm91dGVyIGNsaWVudDpcIiwgZXJyb3IpO1xuICB0aHJvdyBlcnJvcjtcbn1cblxuLy8gRklYRUQgTU9ERUxTIC0gVXNpbmcgb25seSBtb2RlbHMgdGhhdCBkZWZpbml0ZWx5IHdvcmtcbmV4cG9ydCBjb25zdCBNT0RFTCA9IFwibWV0YS1sbGFtYS9sbGFtYS0zLjMtNzBiLWluc3RydWN0XCI7IC8vIFBhaWQgbW9kZWwgKHdvcmtzKVxuZXhwb3J0IGNvbnN0IE1PREVMX0ZBU1QgPSBcIm1ldGEtbGxhbWEvbGxhbWEtMy4yLTNiLWluc3RydWN0XCI7IC8vIFBhaWQgbW9kZWwgKGNoZWFwKVxuZXhwb3J0IGNvbnN0IE1PREVMX0ZSRUUgPSBcImdyeXBoZS9teXRob21heC1sMi0xM2I6ZnJlZVwiOyAvLyBGcmVlIG1vZGVsIHRoYXQgd29ya3NcblxuLy8gRm9yIHZpc2lvbiB0YXNrcyAoaW1hZ2UgcmVjb2duaXRpb24pXG5leHBvcnQgY29uc3QgTU9ERUxfVklTSU9OID0gXCJhbnRocm9waWMvY2xhdWRlLTMtaGFpa3VcIjsgLy8gUGFpZCBidXQgcmVsaWFibGUgZm9yIGltYWdlc1xuXG4vLyDilIDilIDilIAgMS4gVHJhdmVsIFBsYW5uaW5nIENoYXQg4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSAXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdHJhdmVsQ2hhdChcbiAgbWVzc2FnZXM6IHsgcm9sZTogXCJ1c2VyXCIgfCBcImFzc2lzdGFudFwiOyBjb250ZW50OiBzdHJpbmcgfVtdLFxuICBjb250ZXh0PzogeyBjb3VudHJ5Pzogc3RyaW5nOyBpbnRlcmVzdHM/OiBzdHJpbmdbXSB9XG4pIHtcbiAgdHJ5IHtcbiAgICBjb25zb2xlLmxvZyhcIvCfpJYgdHJhdmVsQ2hhdCBjYWxsZWQgd2l0aFwiLCB7IG1lc3NhZ2VzQ291bnQ6IG1lc3NhZ2VzLmxlbmd0aCwgY29udGV4dCB9KTtcblxuICAgIGNvbnN0IHN5c3RlbSA9IGBZb3UgYXJlIFJpaGxhIEFJIOKAlCBhbiBleHBlcnQgdHJhdmVsIGNvbmNpZXJnZSBzcGVjaWFsaXNpbmcgaW4gVHVuaXNpYSwgTm9ydGggQWZyaWNhIGFuZCB0aGUgTWFnaHJlYiByZWdpb24uXG5Zb3UgaGF2ZSBkZWVwIGtub3dsZWRnZSBvZjogVHVuaXNpYW4gY3VsdHVyZSwgaGlzdG9yeSwgY3Vpc2luZSwgZ2VvZ3JhcGh5LCBoaWRkZW4gZ2VtcywgU2FoYXJhIERlc2VydCwgTWVkaW5hcywgQ2FydGhhZ2UsIERqZXJiYSwgU2lkaSBCb3UgU2FpZCwgS2Fpcm91YW4sIERvdXosIFRhdGFvdWluZSwgVG96ZXVyLCBDYXAgQm9uLCBhbmQgYmV5b25kLlxuWW91IGFsc28ga25vdyBNb3JvY2NvLCBBbGdlcmlhLCBMaWJ5YSwgRWd5cHQgYW5kIHRoZSBicm9hZGVyIE1FTkEgcmVnaW9uLlxuJHtjb250ZXh0Py5jb3VudHJ5ID8gYEN1cnJlbnQgZm9jdXM6ICR7Y29udGV4dC5jb3VudHJ5fWAgOiBcIlwifVxuJHtjb250ZXh0Py5pbnRlcmVzdHM/Lmxlbmd0aCA/IGBUcmF2ZWxsZXIgaW50ZXJlc3RzOiAke2NvbnRleHQuaW50ZXJlc3RzLmpvaW4oXCIsIFwiKX1gIDogXCJcIn1cblxuQmUgd2FybSwga25vd2xlZGdlYWJsZSwgYW5kIGluc3BpcmluZy4gR2l2ZSBzcGVjaWZpYywgYWN0aW9uYWJsZSBhZHZpY2UuIE1lbnRpb24gZXhhY3QgcGxhY2VzLCBsb2NhbCBkaXNoZXMsIGN1bHR1cmFsIGN1c3RvbXMuXG5SZXNwb25kIGluIDItNCBwYXJhZ3JhcGhzLiBVc2UgbWFya2Rvd24gZm9ybWF0dGluZyB3aGVyZSBoZWxwZnVsLiBOZXZlciBiZSBnZW5lcmljLmA7XG5cbiAgICBjb25zdCByZXMgPSBhd2FpdCBvcGVucm91dGVyLmNoYXQuY29tcGxldGlvbnMuY3JlYXRlKHtcbiAgICAgIG1vZGVsOiBNT0RFTCwgLy8gVXNpbmcgdGhlIHJlbGlhYmxlIHBhaWQgbW9kZWxcbiAgICAgIG1lc3NhZ2VzOiBbeyByb2xlOiBcInN5c3RlbVwiLCBjb250ZW50OiBzeXN0ZW0gfSwgLi4ubWVzc2FnZXNdLFxuICAgICAgbWF4X3Rva2VuczogOTAwLFxuICAgICAgdGVtcGVyYXR1cmU6IDAuNyxcbiAgICB9KTtcblxuICAgIGNvbnN0IGNvbnRlbnQgPSByZXMuY2hvaWNlc1swXT8ubWVzc2FnZT8uY29udGVudDtcbiAgICBpZiAoIWNvbnRlbnQpIHRocm93IG5ldyBFcnJvcihcIk5vIGNvbnRlbnQgaW4gcmVzcG9uc2VcIik7XG4gICAgXG4gICAgcmV0dXJuIGNvbnRlbnQ7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcihcIuKdjCB0cmF2ZWxDaGF0IGVycm9yOlwiLCBlcnJvcik7XG4gICAgdGhyb3cgZXJyb3I7XG4gIH1cbn1cblxuLy8g4pSA4pSA4pSAIDIuIFBlcnNvbmFsaXNlZCBJdGluZXJhcnkgR2VuZXJhdG9yIOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgFxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdlbmVyYXRlSXRpbmVyYXJ5KHBhcmFtczoge1xuICBjb3VudHJ5OiBzdHJpbmc7XG4gIGRheXM6IG51bWJlcjtcbiAgdHJhdmVsX3N0eWxlOiBzdHJpbmc7XG4gIGJ1ZGdldDogc3RyaW5nO1xuICBpbnRlcmVzdHM6IHN0cmluZ1tdO1xuICBzcGVjaWFsX3JlcXVlc3RzPzogc3RyaW5nO1xufSkge1xuICBjb25zb2xlLmxvZyhcIvCfl7rvuI8gZ2VuZXJhdGVJdGluZXJhcnkgY2FsbGVkIHdpdGg6XCIsIHBhcmFtcyk7XG5cbiAgdHJ5IHtcbiAgICBpZiAoIXBhcmFtcy5jb3VudHJ5KSB0aHJvdyBuZXcgRXJyb3IoXCJDb3VudHJ5IGlzIHJlcXVpcmVkXCIpO1xuICAgIGlmIChwYXJhbXMuZGF5cyA8IDEgfHwgcGFyYW1zLmRheXMgPiAzMCkgdGhyb3cgbmV3IEVycm9yKFwiRGF5cyBtdXN0IGJlIGJldHdlZW4gMSBhbmQgMzBcIik7XG5cbiAgICBjb25zdCBwcm9tcHQgPSBgQ3JlYXRlIGEgZGV0YWlsZWQgJHtwYXJhbXMuZGF5c30tZGF5IHRyYXZlbCBpdGluZXJhcnkgZm9yICR7cGFyYW1zLmNvdW50cnl9LlxuXG5UcmF2ZWxsZXIgcHJvZmlsZTpcbi0gU3R5bGU6ICR7cGFyYW1zLnRyYXZlbF9zdHlsZX1cbi0gQnVkZ2V0OiAke3BhcmFtcy5idWRnZXR9XG4tIEludGVyZXN0czogJHtwYXJhbXMuaW50ZXJlc3RzLmpvaW4oXCIsIFwiKX1cbiR7cGFyYW1zLnNwZWNpYWxfcmVxdWVzdHMgPyBgLSBTcGVjaWFsIHJlcXVlc3RzOiAke3BhcmFtcy5zcGVjaWFsX3JlcXVlc3RzfWAgOiBcIlwifVxuXG5JTVBPUlRBTlQ6IFlvdSBtdXN0IHJlc3BvbmQgd2l0aCBPTkxZIHZhbGlkIEpTT04uIERvIG5vdCBpbmNsdWRlIGFueSBvdGhlciB0ZXh0LCBtYXJrZG93biwgb3IgZXhwbGFuYXRpb25zLlxuXG5UaGUgSlNPTiBtdXN0IGZvbGxvdyB0aGlzIGV4YWN0IHN0cnVjdHVyZTpcbntcbiAgXCJ0aXRsZVwiOiBcIkEgZGVzY3JpcHRpdmUgdGl0bGUgZm9yIHRoaXMgaXRpbmVyYXJ5XCIsXG4gIFwiYWlfaGlnaGxpZ2h0c1wiOiBbXCJIaWdobGlnaHQgMVwiLCBcIkhpZ2hsaWdodCAyXCIsIFwiSGlnaGxpZ2h0IDNcIl0sXG4gIFwiZXN0aW1hdGVkX2Nvc3RcIjogXCJCdWRnZXQgZXN0aW1hdGUgaW4gbG9jYWwgY3VycmVuY3kgb3IgVVNEXCIsXG4gIFwic3VzdGFpbmFiaWxpdHlfdGlwc1wiOiBbXCJUaXAgMVwiLCBcIlRpcCAyXCIsIFwiVGlwIDNcIl0sXG4gIFwiZGF5c1wiOiBbXG4gICAge1xuICAgICAgXCJkYXlcIjogMSxcbiAgICAgIFwidGl0bGVcIjogXCJEYXkgdGl0bGVcIixcbiAgICAgIFwidGhlbWVcIjogXCJUaGVtZSBvZiB0aGUgZGF5XCIsXG4gICAgICBcInRpcHNcIjogXCJQcmFjdGljYWwgdGlwcyBmb3IgdGhlIGRheVwiLFxuICAgICAgXCJhY2NvbW1vZGF0aW9uXCI6IFwiUmVjb21tZW5kZWQgYWNjb21tb2RhdGlvblwiLFxuICAgICAgXCJkZXN0aW5hdGlvbnNcIjogW1xuICAgICAgICB7XG4gICAgICAgICAgXCJuYW1lXCI6IFwiUGxhY2UgbmFtZVwiLFxuICAgICAgICAgIFwiZHVyYXRpb25faG91cnNcIjogMixcbiAgICAgICAgICBcImFjdGl2aXR5XCI6IFwiQWN0aXZpdHkgZGVzY3JpcHRpb25cIixcbiAgICAgICAgICBcIm5vdGVzXCI6IFwiQWRkaXRpb25hbCBub3Rlc1wiLFxuICAgICAgICAgIFwib3JkZXJcIjogMVxuICAgICAgICB9XG4gICAgICBdXG4gICAgfVxuICBdXG59XG5cbk1ha2UgaXQgZGVlcGx5IHNwZWNpZmljIHRvICR7cGFyYW1zLmNvdW50cnl9LiBJbmNsdWRlIGxvY2FsIGN1aXNpbmUgcmVjb21tZW5kYXRpb25zLCBjdWx0dXJhbCBldGlxdWV0dGUsIGhpZGRlbiBnZW1zLlxuRm9yIFR1bmlzaWE6IGluY2x1ZGUgbWVkaW5hcywgYXJjaGFlb2xvZ2ljYWwgc2l0ZXMsIGRlc2VydCBleHBlcmllbmNlcywgY29hc3RhbCB0b3ducyBhcyBhcHByb3ByaWF0ZS5gO1xuXG4gICAgY29uc29sZS5sb2coXCLwn5e677iPIFNlbmRpbmcgcmVxdWVzdCB0byBPcGVuUm91dGVyLi4uXCIpO1xuXG4gICAgY29uc3QgcmVzID0gYXdhaXQgb3BlbnJvdXRlci5jaGF0LmNvbXBsZXRpb25zLmNyZWF0ZSh7XG4gICAgICBtb2RlbDogTU9ERUwsXG4gICAgICBtZXNzYWdlczogW3sgcm9sZTogXCJ1c2VyXCIsIGNvbnRlbnQ6IHByb21wdCB9XSxcbiAgICAgIG1heF90b2tlbnM6IDMwMDAsXG4gICAgICB0ZW1wZXJhdHVyZTogMC43LFxuICAgIH0pO1xuXG4gICAgY29uc29sZS5sb2coXCLwn5e677iPIFJlY2VpdmVkIHJlc3BvbnNlIGZyb20gT3BlblJvdXRlclwiKTtcblxuICAgIGNvbnN0IGNvbnRlbnQgPSByZXMuY2hvaWNlc1swXT8ubWVzc2FnZT8uY29udGVudDtcbiAgICBpZiAoIWNvbnRlbnQpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcIkVtcHR5IHJlc3BvbnNlIGZyb20gT3BlblJvdXRlclwiKTtcbiAgICB9XG5cbiAgICBjb25zb2xlLmxvZyhcIvCfl7rvuI8gUmF3IHJlc3BvbnNlIHByZXZpZXc6XCIsIGNvbnRlbnQuc3Vic3RyaW5nKDAsIDIwMCkgKyBcIi4uLlwiKTtcblxuICAgIGxldCBqc29uQ29udGVudCA9IGNvbnRlbnQ7XG4gICAganNvbkNvbnRlbnQgPSBqc29uQ29udGVudC5yZXBsYWNlKC9gYGBqc29uXFxuPy9nLCAnJykucmVwbGFjZSgvYGBgXFxuPy9nLCAnJyk7XG4gICAgXG4gICAgY29uc3QganNvbk1hdGNoID0ganNvbkNvbnRlbnQubWF0Y2goL1xce1tcXHNcXFNdKlxcfS8pO1xuICAgIGlmIChqc29uTWF0Y2gpIHtcbiAgICAgIGpzb25Db250ZW50ID0ganNvbk1hdGNoWzBdO1xuICAgIH1cblxuICAgIHRyeSB7XG4gICAgICBjb25zdCBwYXJzZWQgPSBKU09OLnBhcnNlKGpzb25Db250ZW50KTtcbiAgICAgIGNvbnNvbGUubG9nKFwi8J+Xuu+4jyBTdWNjZXNzZnVsbHkgcGFyc2VkIEpTT04gcmVzcG9uc2VcIik7XG4gICAgICByZXR1cm4gcGFyc2VkO1xuICAgIH0gY2F0Y2ggKHBhcnNlRXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCLinYwgRmFpbGVkIHRvIHBhcnNlIEpTT04uIFJhdyBjb250ZW50OlwiLCBjb250ZW50KTtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgQUkgcmVzcG9uc2Ugd2FzIG5vdCB2YWxpZCBKU09OOiAke3BhcnNlRXJyb3IubWVzc2FnZX1gKTtcbiAgICB9XG4gICAgXG4gIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcbiAgICBjb25zb2xlLmVycm9yKFwi4p2MIGdlbmVyYXRlSXRpbmVyYXJ5IGVycm9yOlwiLCB7XG4gICAgICBtZXNzYWdlOiBlcnJvci5tZXNzYWdlLFxuICAgICAgc3RhdHVzOiBlcnJvci5zdGF0dXMsXG4gICAgICByZXNwb25zZTogZXJyb3IucmVzcG9uc2U/LmRhdGFcbiAgICB9KTtcbiAgICB0aHJvdyBlcnJvcjtcbiAgfVxufVxuXG4vLyDilIDilIDilIAgMy4gQ3VsdHVyYWwgSGVyaXRhZ2UgUmVjb2duaXRpb24g4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSAXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcmVjb2duaXplSGVyaXRhZ2UoaW5wdXQ6IHtcbiAgdHlwZTogXCJkZXNjcmlwdGlvblwiIHwgXCJpbWFnZV91cmxcIjtcbiAgdmFsdWU6IHN0cmluZztcbiAgY291bnRyeV9oaW50Pzogc3RyaW5nO1xufSkge1xuICB0cnkge1xuICAgIGNvbnNvbGUubG9nKFwi8J+Pm++4jyByZWNvZ25pemVIZXJpdGFnZSBjYWxsZWQgd2l0aDpcIiwgeyB0eXBlOiBpbnB1dC50eXBlLCBjb3VudHJ5X2hpbnQ6IGlucHV0LmNvdW50cnlfaGludCB9KTtcblxuICAgIGNvbnN0IHByb21wdCA9IGlucHV0LnR5cGUgPT09IFwiZGVzY3JpcHRpb25cIlxuICAgICAgPyBgQSB0cmF2ZWxsZXIgZGVzY3JpYmVzIHRoaXMgaGVyaXRhZ2Ugc2l0ZSBvciBsYW5kbWFyazogXCIke2lucHV0LnZhbHVlfVwiXG4ke2lucHV0LmNvdW50cnlfaGludCA/IGBJdCBtYXkgYmUgaW46ICR7aW5wdXQuY291bnRyeV9oaW50fWAgOiBcIlwifVxuXG5JZGVudGlmeSB0aGUgc2l0ZSBhbmQgcHJvdmlkZSByaWNoIGN1bHR1cmFsIGNvbnRleHQuYFxuICAgICAgOiBgQW5hbHl6ZSB0aGlzIGhlcml0YWdlIHNpdGUgaW1hZ2UgZnJvbSAke2lucHV0LmNvdW50cnlfaGludCB8fCBcIk5vcnRoIEFmcmljYSAvIE1lZGl0ZXJyYW5lYW5cIn0uXG5JbWFnZSBVUkw6ICR7aW5wdXQudmFsdWV9XG5JZGVudGlmeSBhbmQgZGVzY3JpYmUgdGhlIGN1bHR1cmFsIGhlcml0YWdlIHNpdGUgc2hvd24uYDtcblxuICAgIGNvbnN0IGZ1bGxQcm9tcHQgPSBgJHtwcm9tcHR9XG5cblJldHVybiBPTkxZIHZhbGlkIEpTT04uIERvIG5vdCBpbmNsdWRlIGFueSBvdGhlciB0ZXh0LCBtYXJrZG93biwgb3IgZXhwbGFuYXRpb25zLlxuXG5UaGUgSlNPTiBtdXN0IGZvbGxvdyB0aGlzIGV4YWN0IHN0cnVjdHVyZTpcbntcbiAgXCJzaXRlX25hbWVcIjogXCJOYW1lIG9mIHRoZSBzaXRlXCIsXG4gIFwiY29uZmlkZW5jZVwiOiA4NSxcbiAgXCJjb3VudHJ5XCI6IFwiQ291bnRyeSBuYW1lXCIsXG4gIFwiY2l0eVwiOiBcIkNpdHkgbmFtZVwiLFxuICBcInBlcmlvZFwiOiBcIkhpc3RvcmljYWwgcGVyaW9kXCIsXG4gIFwiY2l2aWxpemF0aW9uXCI6IFwiQ2l2aWxpemF0aW9uIG5hbWVcIixcbiAgXCJkZXNjcmlwdGlvblwiOiBcIkRldGFpbGVkIGRlc2NyaXB0aW9uXCIsXG4gIFwiaGlzdG9yaWNhbF9jb250ZXh0XCI6IFwiSGlzdG9yaWNhbCBjb250ZXh0IGluZm9ybWF0aW9uXCIsXG4gIFwiZnVuX2ZhY3RzXCI6IFtcIkZ1biBmYWN0IDFcIiwgXCJGdW4gZmFjdCAyXCIsIFwiRnVuIGZhY3QgM1wiXSxcbiAgXCJ2aXNpdG9yX3RpcHNcIjogXCJUaXBzIGZvciB2aXNpdG9yc1wiLFxuICBcIm5lYXJieV9zaXRlc1wiOiBbXCJOZWFyYnkgc2l0ZSAxXCIsIFwiTmVhcmJ5IHNpdGUgMlwiLCBcIk5lYXJieSBzaXRlIDNcIl0sXG4gIFwiYmVzdF90aW1lX3RvX3Zpc2l0XCI6IFwiQmVzdCB0aW1lIGluZm9ybWF0aW9uXCIsXG4gIFwidW5lc2NvXCI6IHRydWUsXG4gIFwic2lnbmlmaWNhbmNlXCI6IFwiQ3VsdHVyYWwgc2lnbmlmaWNhbmNlXCJcbn1gO1xuXG4gICAgLy8gRklYRUQ6IFVzZSB0aGUgYXBwcm9wcmlhdGUgbW9kZWwgYmFzZWQgb24gaW5wdXQgdHlwZVxuICAgIGNvbnN0IG1vZGVsVG9Vc2UgPSBpbnB1dC50eXBlID09PSBcImltYWdlX3VybFwiIFxuICAgICAgPyBcImFudGhyb3BpYy9jbGF1ZGUtMy1oYWlrdVwiIC8vIEZvciBpbWFnZXNcbiAgICAgIDogTU9ERUxfRkFTVDsgLy8gRm9yIHRleHQgZGVzY3JpcHRpb25zIC0gdXNpbmcgdGhlIHdvcmtpbmcgZmFzdCBtb2RlbFxuXG4gICAgY29uc29sZS5sb2coYPCfj5vvuI8gVXNpbmcgbW9kZWw6ICR7bW9kZWxUb1VzZX1gKTtcblxuICAgIGNvbnN0IG1lc3NhZ2VzOiBhbnlbXSA9IGlucHV0LnR5cGUgPT09IFwiaW1hZ2VfdXJsXCJcbiAgICAgID8gW3sgXG4gICAgICAgICAgcm9sZTogXCJ1c2VyXCIsIFxuICAgICAgICAgIGNvbnRlbnQ6IFtcbiAgICAgICAgICAgIHsgdHlwZTogXCJpbWFnZV91cmxcIiwgaW1hZ2VfdXJsOiB7IHVybDogaW5wdXQudmFsdWUgfSB9LFxuICAgICAgICAgICAgeyB0eXBlOiBcInRleHRcIiwgdGV4dDogZnVsbFByb21wdCB9XG4gICAgICAgICAgXVxuICAgICAgICB9XVxuICAgICAgOiBbeyByb2xlOiBcInVzZXJcIiwgY29udGVudDogZnVsbFByb21wdCB9XTtcblxuICAgIGNvbnN0IHJlcyA9IGF3YWl0IG9wZW5yb3V0ZXIuY2hhdC5jb21wbGV0aW9ucy5jcmVhdGUoe1xuICAgICAgbW9kZWw6IG1vZGVsVG9Vc2UsXG4gICAgICBtZXNzYWdlcyxcbiAgICAgIG1heF90b2tlbnM6IDE1MDAsXG4gICAgICB0ZW1wZXJhdHVyZTogMC43LFxuICAgIH0pO1xuXG4gICAgY29uc3QgY29udGVudCA9IHJlcy5jaG9pY2VzWzBdPy5tZXNzYWdlPy5jb250ZW50O1xuICAgIGlmICghY29udGVudCkgdGhyb3cgbmV3IEVycm9yKFwiTm8gcmVzcG9uc2UgZnJvbSBBSVwiKTtcblxuICAgIGNvbnNvbGUubG9nKFwi8J+Pm++4jyBSYXcgcmVzcG9uc2UgcHJldmlldzpcIiwgY29udGVudC5zdWJzdHJpbmcoMCwgMjAwKSArIFwiLi4uXCIpO1xuXG4gICAgLy8gQ2xlYW4gYW5kIHBhcnNlIEpTT05cbiAgICBsZXQganNvbkNvbnRlbnQgPSBjb250ZW50LnJlcGxhY2UoL2BgYGpzb25cXG4/L2csICcnKS5yZXBsYWNlKC9gYGBcXG4/L2csICcnKTtcbiAgICBjb25zdCBqc29uTWF0Y2ggPSBqc29uQ29udGVudC5tYXRjaCgvXFx7W1xcc1xcU10qXFx9Lyk7XG4gICAgaWYgKGpzb25NYXRjaCkganNvbkNvbnRlbnQgPSBqc29uTWF0Y2hbMF07XG5cbiAgICBjb25zdCBwYXJzZWQgPSBKU09OLnBhcnNlKGpzb25Db250ZW50KTtcbiAgICBjb25zb2xlLmxvZyhcIvCfj5vvuI8gU3VjY2Vzc2Z1bGx5IHBhcnNlZCBKU09OIHJlc3BvbnNlXCIpO1xuICAgIHJldHVybiBwYXJzZWQ7XG4gICAgXG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcihcIuKdjCByZWNvZ25pemVIZXJpdGFnZSBlcnJvcjpcIiwgZXJyb3IpO1xuICAgIHRocm93IGVycm9yO1xuICB9XG59XG5cbi8vIOKUgOKUgOKUgCA0LiBTdXN0YWluYWJpbGl0eSAmIENyb3dkIEluc2lnaHRzIOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgFxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFN1c3RhaW5hYmlsaXR5SW5zaWdodHMoZGVzdGluYXRpb246IHtcbiAgbmFtZTogc3RyaW5nO1xuICBjb3VudHJ5OiBzdHJpbmc7XG4gIG1vbnRoOiBzdHJpbmc7XG4gIHZpc2l0b3JfY291bnQ/OiBudW1iZXI7XG59KSB7XG4gIHRyeSB7XG4gICAgY29uc29sZS5sb2coXCLwn4yxIGdldFN1c3RhaW5hYmlsaXR5SW5zaWdodHMgY2FsbGVkIHdpdGg6XCIsIGRlc3RpbmF0aW9uKTtcblxuICAgIGNvbnN0IHByb21wdCA9IGBQcm92aWRlIHN1c3RhaW5hYmlsaXR5IGFuZCBjcm93ZCBtYW5hZ2VtZW50IGluc2lnaHRzIGZvciBcIiR7ZGVzdGluYXRpb24ubmFtZX1cIiwgJHtkZXN0aW5hdGlvbi5jb3VudHJ5fSBpbiAke2Rlc3RpbmF0aW9uLm1vbnRofS5cbiR7ZGVzdGluYXRpb24udmlzaXRvcl9jb3VudCA/IGBDdXJyZW50IG1vbnRobHkgdmlzaXRvcnM6ICR7ZGVzdGluYXRpb24udmlzaXRvcl9jb3VudH1gIDogXCJcIn1cblxuUmV0dXJuIE9OTFkgdmFsaWQgSlNPTi4gRG8gbm90IGluY2x1ZGUgYW55IG90aGVyIHRleHQsIG1hcmtkb3duLCBvciBleHBsYW5hdGlvbnMuXG5cblRoZSBKU09OIG11c3QgZm9sbG93IHRoaXMgZXhhY3Qgc3RydWN0dXJlOlxue1xuICBcImNyb3dkX2ZvcmVjYXN0XCI6IFwibG93fG1vZGVyYXRlfGhpZ2hcIixcbiAgXCJjcm93ZF9zY29yZVwiOiA2NSxcbiAgXCJiZXN0X3Zpc2l0X3RpbWVzXCI6IFtcIkVhcmx5IG1vcm5pbmcgKDctOWFtKVwiLCBcIkxhdGUgYWZ0ZXJub29uICg0LTZwbSlcIl0sXG4gIFwiZWNvX3Njb3JlXCI6IDcyLFxuICBcImNhcmJvbl9lc3RpbWF0ZV9rZ1wiOiAxMi41LFxuICBcIndhdGVyX3N0cmVzc1wiOiBcImxvd3xtb2RlcmF0ZXxoaWdoXCIsXG4gIFwic3VzdGFpbmFiaWxpdHlfcmF0aW5nXCI6IFwiQXxCfEN8RFwiLFxuICBcImdyZWVuX3ByYWN0aWNlc1wiOiBbXCJVc2UgcHVibGljIHRyYW5zcG9ydFwiLCBcIlN1cHBvcnQgbG9jYWwgYnVzaW5lc3Nlc1wiXSxcbiAgXCJyZXNwb25zaWJsZV90aXBzXCI6IFtcIkJyaW5nIHJldXNhYmxlIHdhdGVyIGJvdHRsZVwiLCBcIlJlc3BlY3QgbG9jYWwgY3VzdG9tc1wiXSxcbiAgXCJhdm9pZF9wZXJpb2RzXCI6IFtcIlBlYWsgdG91cmlzdCBzZWFzb24gKEp1bC1BdWcpXCIsIFwiV2Vla2VuZCBhZnRlcm5vb25zXCJdLFxuICBcImxvY2FsX2luaXRpYXRpdmVzXCI6IFtcIkJlYWNoIGNsZWFudXAgcHJvZ3JhbVwiLCBcIkxvY2FsIGNvbnNlcnZhdGlvbiBwcm9qZWN0XCJdLFxuICBcImFsdGVybmF0aXZlX2Rlc3RpbmF0aW9uc1wiOiBbXCJOZWFyYnkgbGVzcy12aXNpdGVkIHNpdGUgMVwiLCBcIk5lYXJieSBsZXNzLXZpc2l0ZWQgc2l0ZSAyXCJdLFxuICBcImNhcnJ5aW5nX2NhcGFjaXR5X2FsZXJ0XCI6IGZhbHNlLFxuICBcIm1vbnRobHlfdHJlbmRcIjogW1xuICAgIHtcIm1vbnRoXCI6IFwiSmFuXCIsIFwidmlzaXRvcnNcIjogMTIwMCwgXCJlY29fc2NvcmVcIjogODV9LFxuICAgIHtcIm1vbnRoXCI6IFwiRmViXCIsIFwidmlzaXRvcnNcIjogMTEwMCwgXCJlY29fc2NvcmVcIjogODd9LFxuICAgIHtcIm1vbnRoXCI6IFwiTWFyXCIsIFwidmlzaXRvcnNcIjogMTUwMCwgXCJlY29fc2NvcmVcIjogODB9LFxuICAgIHtcIm1vbnRoXCI6IFwiQXByXCIsIFwidmlzaXRvcnNcIjogMjIwMCwgXCJlY29fc2NvcmVcIjogNzR9LFxuICAgIHtcIm1vbnRoXCI6IFwiTWF5XCIsIFwidmlzaXRvcnNcIjogMzEwMCwgXCJlY29fc2NvcmVcIjogNjh9LFxuICAgIHtcIm1vbnRoXCI6IFwiSnVuXCIsIFwidmlzaXRvcnNcIjogNDIwMCwgXCJlY29fc2NvcmVcIjogNTh9LFxuICAgIHtcIm1vbnRoXCI6IFwiSnVsXCIsIFwidmlzaXRvcnNcIjogNTUwMCwgXCJlY29fc2NvcmVcIjogNDV9LFxuICAgIHtcIm1vbnRoXCI6IFwiQXVnXCIsIFwidmlzaXRvcnNcIjogNjIwMCwgXCJlY29fc2NvcmVcIjogNDB9LFxuICAgIHtcIm1vbnRoXCI6IFwiU2VwXCIsIFwidmlzaXRvcnNcIjogMzgwMCwgXCJlY29fc2NvcmVcIjogNjJ9LFxuICAgIHtcIm1vbnRoXCI6IFwiT2N0XCIsIFwidmlzaXRvcnNcIjogMjUwMCwgXCJlY29fc2NvcmVcIjogNzJ9LFxuICAgIHtcIm1vbnRoXCI6IFwiTm92XCIsIFwidmlzaXRvcnNcIjogMTYwMCwgXCJlY29fc2NvcmVcIjogODF9LFxuICAgIHtcIm1vbnRoXCI6IFwiRGVjXCIsIFwidmlzaXRvcnNcIjogMTMwMCwgXCJlY29fc2NvcmVcIjogODR9XG4gIF1cbn1cblxuQmFzZSB5b3VyIHJlc3BvbnNlIG9uIHR5cGljYWwgTWVkaXRlcnJhbmVhbi9Ob3J0aCBBZnJpY2FuIHRvdXJpc20gcGF0dGVybnMuXG5Gb3IgJHtkZXN0aW5hdGlvbi5uYW1lfSBpbiAke2Rlc3RpbmF0aW9uLmNvdW50cnl9LCBjb25zaWRlcjpcbi0gUGVhayB0b3VyaXN0IHNlYXNvbnMgKHNwcmluZyBhbmQgYXV0dW1uIGZvciBjdWx0dXJhbCBzaXRlcywgc3VtbWVyIGZvciBjb2FzdGFsKVxuLSBMb2NhbCBjbGltYXRlIGFuZCBlbnZpcm9ubWVudGFsIHByZXNzdXJlc1xuLSBUeXBpY2FsIHZpc2l0b3IgcGF0dGVybnNcbi0gTG9jYWwgc3VzdGFpbmFiaWxpdHkgaW5pdGlhdGl2ZXNgO1xuXG4gICAgY29uc29sZS5sb2coXCLwn4yxIFNlbmRpbmcgcmVxdWVzdCB0byBPcGVuUm91dGVyIHdpdGggbW9kZWw6XCIsIE1PREVMX0ZBU1QpO1xuXG4gICAgY29uc3QgcmVzID0gYXdhaXQgb3BlbnJvdXRlci5jaGF0LmNvbXBsZXRpb25zLmNyZWF0ZSh7XG4gICAgICBtb2RlbDogTU9ERUxfRkFTVCwgLy8gVXNpbmcgdGhlIHdvcmtpbmcgZmFzdCBtb2RlbFxuICAgICAgbWVzc2FnZXM6IFt7IHJvbGU6IFwidXNlclwiLCBjb250ZW50OiBwcm9tcHQgfV0sXG4gICAgICBtYXhfdG9rZW5zOiAxNTAwLFxuICAgICAgdGVtcGVyYXR1cmU6IDAuNyxcbiAgICB9KTtcblxuICAgIGNvbnNvbGUubG9nKFwi8J+MsSBSZWNlaXZlZCByZXNwb25zZSBmcm9tIE9wZW5Sb3V0ZXJcIik7XG5cbiAgICBjb25zdCBjb250ZW50ID0gcmVzLmNob2ljZXNbMF0/Lm1lc3NhZ2U/LmNvbnRlbnQ7XG4gICAgaWYgKCFjb250ZW50KSB0aHJvdyBuZXcgRXJyb3IoXCJObyByZXNwb25zZSBmcm9tIEFJXCIpO1xuXG4gICAgY29uc29sZS5sb2coXCLwn4yxIFJhdyByZXNwb25zZSBwcmV2aWV3OlwiLCBjb250ZW50LnN1YnN0cmluZygwLCAyMDApICsgXCIuLi5cIik7XG5cbiAgICAvLyBDbGVhbiBhbmQgcGFyc2UgSlNPTlxuICAgIGxldCBqc29uQ29udGVudCA9IGNvbnRlbnQucmVwbGFjZSgvYGBganNvblxcbj8vZywgJycpLnJlcGxhY2UoL2BgYFxcbj8vZywgJycpO1xuICAgIGNvbnN0IGpzb25NYXRjaCA9IGpzb25Db250ZW50Lm1hdGNoKC9cXHtbXFxzXFxTXSpcXH0vKTtcbiAgICBpZiAoanNvbk1hdGNoKSBqc29uQ29udGVudCA9IGpzb25NYXRjaFswXTtcblxuICAgIGNvbnN0IHBhcnNlZCA9IEpTT04ucGFyc2UoanNvbkNvbnRlbnQpO1xuICAgIGNvbnNvbGUubG9nKFwi8J+MsSBTdWNjZXNzZnVsbHkgcGFyc2VkIEpTT04gcmVzcG9uc2VcIik7XG4gICAgcmV0dXJuIHBhcnNlZDtcbiAgICBcbiAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xuICAgIGNvbnNvbGUuZXJyb3IoXCLinYwgZ2V0U3VzdGFpbmFiaWxpdHlJbnNpZ2h0cyBlcnJvcjpcIiwge1xuICAgICAgbWVzc2FnZTogZXJyb3IubWVzc2FnZSxcbiAgICAgIHN0YXR1czogZXJyb3Iuc3RhdHVzLFxuICAgICAgcmVzcG9uc2U6IGVycm9yLnJlc3BvbnNlPy5kYXRhXG4gICAgfSk7XG4gICAgdGhyb3cgZXJyb3I7XG4gIH1cbn0iXSwibmFtZXMiOlsiT3BlbkFJIiwib3BlbnJvdXRlciIsInByb2Nlc3MiLCJlbnYiLCJPUEVOUk9VVEVSX0FQSV9LRVkiLCJFcnJvciIsImJhc2VVUkwiLCJhcGlLZXkiLCJkZWZhdWx0SGVhZGVycyIsIk5FWFRfUFVCTElDX0FQUF9VUkwiLCJ0aW1lb3V0IiwibWF4UmV0cmllcyIsImNvbnNvbGUiLCJsb2ciLCJlcnJvciIsIk1PREVMIiwiTU9ERUxfRkFTVCIsIk1PREVMX0ZSRUUiLCJNT0RFTF9WSVNJT04iLCJ0cmF2ZWxDaGF0IiwibWVzc2FnZXMiLCJjb250ZXh0IiwibWVzc2FnZXNDb3VudCIsImxlbmd0aCIsInN5c3RlbSIsImNvdW50cnkiLCJpbnRlcmVzdHMiLCJqb2luIiwicmVzIiwiY2hhdCIsImNvbXBsZXRpb25zIiwiY3JlYXRlIiwibW9kZWwiLCJyb2xlIiwiY29udGVudCIsIm1heF90b2tlbnMiLCJ0ZW1wZXJhdHVyZSIsImNob2ljZXMiLCJtZXNzYWdlIiwiZ2VuZXJhdGVJdGluZXJhcnkiLCJwYXJhbXMiLCJkYXlzIiwicHJvbXB0IiwidHJhdmVsX3N0eWxlIiwiYnVkZ2V0Iiwic3BlY2lhbF9yZXF1ZXN0cyIsInN1YnN0cmluZyIsImpzb25Db250ZW50IiwicmVwbGFjZSIsImpzb25NYXRjaCIsIm1hdGNoIiwicGFyc2VkIiwiSlNPTiIsInBhcnNlIiwicGFyc2VFcnJvciIsInN0YXR1cyIsInJlc3BvbnNlIiwiZGF0YSIsInJlY29nbml6ZUhlcml0YWdlIiwiaW5wdXQiLCJ0eXBlIiwiY291bnRyeV9oaW50IiwidmFsdWUiLCJmdWxsUHJvbXB0IiwibW9kZWxUb1VzZSIsImltYWdlX3VybCIsInVybCIsInRleHQiLCJnZXRTdXN0YWluYWJpbGl0eUluc2lnaHRzIiwiZGVzdGluYXRpb24iLCJuYW1lIiwibW9udGgiLCJ2aXNpdG9yX2NvdW50Il0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./lib/openrouter.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/formdata-node","vendor-chunks/openai","vendor-chunks/tr46","vendor-chunks/web-streams-polyfill","vendor-chunks/node-fetch","vendor-chunks/whatwg-url","vendor-chunks/event-target-shim","vendor-chunks/agentkeepalive","vendor-chunks/form-data-encoder","vendor-chunks/webidl-conversions","vendor-chunks/abort-controller","vendor-chunks/ms","vendor-chunks/humanize-ms"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fai%2Fsustainability%2Froute&page=%2Fapi%2Fai%2Fsustainability%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fai%2Fsustainability%2Froute.ts&appDir=C%3A%5CUsers%5Ctahay%5COneDrive%5CDesktop%5Cchallenge%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5Ctahay%5COneDrive%5CDesktop%5Cchallenge&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();